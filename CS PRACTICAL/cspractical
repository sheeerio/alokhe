import mysql.connector as sql
import datetime
import time

airline=sql.connect(host='localhost',user='root',password='cs',database='airlines')
if airline.is_connected():
    print('connected')
 
print('')
print('')
print('WELCOME TO FARTS: Fair Airline Ticketing Reservation System')
print('')
print('')
print('TO LOGIN PRESS :1 ')
print('')
print('')
print('TO CREATE YOUR NEW ACCOUNT PRESS :2 ')
print('')
print('')
print('TO EXIT PRESS :3 ')
print('')
   
c=int(input('Enter your choice :'))
if (c==1):
    print('')
    print('To login please enter your user id and password')
    print('')
    user_id=input('Enter your user id :')
    print('')
    password=input('Enter your password :')
    print('')
    name=input('Enter your name :')
    print('')
    c1=airline.cursor()
    c1.execute('select * from airplane_name')
    data=c1.fetchall()
    count=c1.rowcount
    for row in data:
        if (user_id in row) and (password in row):
            print(' ')
            print('SUCCESFUL LOGIN')
            print('This is ',name)
            print(' ')
            print(' ')
            print('To see reservation details press :1 ')
            print(' ')
            print('To make reservations press :2 ')
            print(' ')
            print('To see your past reservations :3 ')
            print('')
            print('To update your open reservations :4 ')
            print('')
            c2=int(input('Enter your choice :'))
            if (c2==1):
                c1=airline.cursor()
                c1.execute('select * from reservation')
                data=c1.fetchall()
                count=c1.rowcount
                print('Total reservation(s) made are ',count)
                for row in data:
                    print(row)
            elif (c2==2):
                print('')
                print('To create a reservation')
                print('')
                destination=int(input('Enter destination :'))
                print('')
                date=input('Enter date of departure [in DD/MM/YYYY] :')
                print('')
                time.sleep(3)
                print('1. Vistara\n2.Jet Airways\n3. Air India\n4.Emirates\n5.IndiGo\n6.SpiceJet?\n7.AirAsia India')
                airline=int(input('Select Airline [number] :'))
                print('')
                s=seat.cursor()
                seats_l=s.execute('select seats_left from seat_details where destination='+destination+' AND date='+date)
                seats_left=seats_l.fetchall()
                print('Available seats of '+airline+' that go to '+destination+' are :'+str(seats_left))
                seat=input('choose your seat number :')
                print('')
                v=seat_details.cursor()
                v.execute('select price from seat_details')
                val=v.execute('select price where seat='+seat)
                payment=int(input('Pay Value :'+val))
                print('')
                time.sleep(2)
                print('Reserved.')
                c1=airline.cursor()
                update_details="Insert into user values("+ str(airplane_id) +",'"+ (airplane_name) +"','"+ str(airplane_amt_paid) +")"
                c1.execute(update_details)
                airline.commit()
                print('User details succesully updated')
            elif (c2==3):
                   print('You have made the following reservations'+seat+', '+airline+', '+destination)
                   c1=airline.cursor()
                   c1.execute('select seat_list from reservations')
                   data=c1.fetchall()
                   data=list(data)
                   for i in range(len(data)):
                       print(data[i]+'\n')
            elif (c2==4):
                   print('')
                   print('To update reservations enter the following details')
                   reservation_id=int(input('Enter your reservation id(in integer) :'))
                   reservation_update=input('Do you want to 1.cancel your reservation or 2.reschedule it? [press 1 or 2] :')
                   if reservation_update=='1':
                       print('Your reservation has been cancelled. Thank you for considering our platform for reserving.')
                   elif reservation_update=='2':
                       global preferred_date
                       preferred_date = (input(print('What date do you prefer? [in DD/MM/YYYY]')))
                   else:
                       break
                   c1=airline.cursor()
                   updates2=("insert into seat_list values('"+ str(reservation_id) +"','"+ (preferred_date)+"')")
                   c1.execute(updates2)
                   airline.commit()
                   print('Reservation has been updated')
            else:
                  ('Error 400 Bad Request')
    
elif (c==2):
    print('')
    print('To create your account please enter your user id and password')
    print('')
    c1=airline.cursor()
    airplane_id=int(input('Choose your user id (in integer) :'))
    print('')
    airplane_password=int(input('Create your password (in integer) :'))
    print('')
    airplane_name=input('Enter your full  name :')
    print('')
    c1=airline.cursor()
    update=("Insert into airline values("+ str(airplane_id) +","+ str(airplane_password) +",'"+ (airplane_name) +"')")
    c1.execute(update)
    airline.commit()
    print('Account has been created')
elif (c==3):
    print('Visit again')
    print('')
    print('Thank you')
else:
    ('Error 503 Service Unavailable')